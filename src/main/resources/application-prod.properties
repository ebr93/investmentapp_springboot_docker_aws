# ===============================
# PROD (AWS/RDS)
# Flyway owns the schema via migrations
# Hibernate only validates mapping vs schema
# ===============================

# --- Datasource (REQUIRED via env vars in production) ---
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Optional but recommended connection tuning (safe to commit)
spring.datasource.hikari.maximum-pool-size=${SPRING_DATASOURCE_POOL_SIZE:10}
spring.datasource.hikari.minimum-idle=${SPRING_DATASOURCE_MIN_IDLE:2}
spring.datasource.hikari.connection-timeout=${SPRING_DATASOURCE_CONN_TIMEOUT_MS:30000}
spring.datasource.hikari.idle-timeout=${SPRING_DATASOURCE_IDLE_TIMEOUT_MS:600000}
spring.datasource.hikari.max-lifetime=${SPRING_DATASOURCE_MAX_LIFETIME_MS:1800000}

# --- Flyway (schema owner) ---
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration

# Safety: never allow destructive operations in production
spring.flyway.clean-disabled=true

# Optional: if you ever need baseline on an existing DB (usually false for fresh RDS)
spring.flyway.baseline-on-migrate=${SPRING_FLYWAY_BASELINE_ON_MIGRATE:false}

# --- Hibernate/JPA (NO schema creation here; Flyway does it) ---
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.properties.hibernate.globally_quoted_identifiers=true

# --- Keep logs clean in prod ---
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
logging.level.org.hibernate.SQL=OFF
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=OFF

# --- Server ---
server.port=${PORT:8080}

# --- App secrets / API keys (env var only; safe to commit placeholders) ---
# Replace these keys with your real property names (whatever your code uses)
# example:

market.api.key=${MARKET_API_KEY}
market.api.host=${MARKET_API_HOST:apidojo-yahoo-finance-v1.p.rapidapi.com}

# openai.apiKey=${OPENAI_API_KEY}
